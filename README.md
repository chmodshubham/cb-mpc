# Benchmark Webpage Generator

This tool is used to generate a static website based on dynamic data that are generated during github action. A sample workflow is as follows.
- A commit is pushed to `master`
- A github action is triggered that will run benchmark commands and produce benchmark data
- Benchmark data is
  - either a summary data (a single file called `github_action.json`)
  - or a data per each benchmark type (e.g., for core-bn, ...) that will show a graph. These files are called `data.js` and are differentiated based on the directory they reside in.
- Once all the benchmark data are generated, they are committed to the `gh-pages` branch
- After that, this code is run to generate the web-page for showing these data


As a result, during development and actual usage, we need to differentiate between two directories:
1. A `data` directory which contains all the data and contains the following:
   - `data/aggregated_benchmarks.json`
   - `data/individual_benchmarks/BENCHMARK_TYPE/data.js` for example `data/individual_benchmarks/core-bn/data.js`
   - `data/commit-sha.txt`
   - `data/logo.png`
   - `data/index.html`

   where the logo and index.html are defined manually and rest are potentially generated by github cations after a commit is pushed to master.
2. A `docs` directory which contains the html code that will be shown while the users go to `pages.github.com/coinbase/cb-mpc/index.html` page. These html files are generated by this tool.


## Deploy and Run

Run

```bash
make build
```

then commit the changes in the `docs` directory and push to `gh-pages` branch.


## Dev workflow

Run these to initialize the project

```bash
make dev-setup
```

For dev setup run the following three commands in separate terminals:

```bash
make dev       # For hot-reloading of code generation
make dev-css   # for hot-reloading of css generation
make dev-serve # To serve the generated files at localhost:8000/c3/cb-mpc/index.html
```